<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Whitelist Inserter/Deleter</title>
    <style>
        /* CSS Değişkenleri - Tekrar Eden Değerler */
        :root {
            /* Renkler */
            --bg-primary: #22272e;
            --bg-secondary: #2d333b;
            --bg-tertiary: #1c2128;
            --border-color: #444c56;
            --text-primary: #adbac7;
            --text-secondary: #c9d1d9;
            --text-muted: #8b949e;
            --text-placeholder: #6e7681;
            --accent-blue: #58a6ff;
            --accent-blue-light: #a1cdff;
            --accent-blue-active: #63acff;
            --accent-red: #f85149;
            --accent-orange: #e3b341;
            --shadow-light: rgba(0,0,0,0.2);
            --shadow-medium: rgba(0,0,0,0.3);
            --focus-glow: rgba(88,166,255,0.3);
            
            /* Boyutlar */
            --container-width: 90%;
            --container-max-width: 950px;
            --border-radius: 8px;
            --border-radius-large: 12px;
            --spacing-xs: 5px;
            --spacing-sm: 10px;
            --spacing-md: 15px;
            --spacing-lg: 20px;
            --spacing-xl: 25px;
            --spacing-xxl: 30px;
            
            /* Tipografi */
            --font-primary: 'Inter', sans-serif;
            --font-code: 'Fira Code', 'Consolas', 'Monaco', monospace;
            --font-size-sm: 0.85em;
            --font-size-md: 0.95em;
            --font-size-lg: 1.15em;
            --font-size-xl: 1.2em;
            --font-size-xxl: 2.5em;
            
            /* Geçişler */
            --transition-fast: 0.1s;
            --transition-normal: 0.2s;
            --transition-slow: 0.3s;
        }

        /* Genel Stil ve Koyu Tema Ayarları */
        body {
            font-family: var(--font-primary);
            margin: 0;
            padding: var(--spacing-lg);
            background-color: var(--bg-primary);
            color: var(--text-primary);
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            box-sizing: border-box;
        }

        h1 {
            color: var(--text-secondary);
            margin-bottom: 35px;
            font-size: var(--font-size-xxl);
            letter-spacing: 1.5px;
            text-shadow: 0 2px 5px var(--shadow-medium);
            text-align: center;
        }

        /* Ortak Konteyner Stilleri */
        .container, #sqlOutputContainer {
            width: var(--container-width);
            max-width: var(--container-max-width);
            background-color: var(--bg-secondary);
            padding: var(--spacing-xxl);
            border-radius: var(--border-radius-large);
            box-shadow: 0 8px 20px var(--shadow-medium);
            border: 1px solid var(--border-color);
        }

        .container {
            margin-bottom: 40px;
        }

        /* Bilgi Notları */
        .info-notes {
            margin-bottom: var(--spacing-xl);
            padding-bottom: var(--spacing-xl);
            border-bottom: 1px solid var(--border-color);
        }
        
        .info-notes p {
            font-size: var(--font-size-md);
            line-height: 1.6;
            margin-bottom: var(--spacing-sm);
        }
        
        .info-notes p:last-child {
            margin-bottom: 0;
        }
        
        .info-notes .red-note {
            color: var(--accent-red);
            font-weight: bold;
        }
        
        .info-notes .orange-note {
            color: var(--accent-orange);
        }

        /* Her Bir Alan Satırı */
        .item-row {
            display: flex;
            align-items: flex-start;
            margin-bottom: var(--spacing-sm);
            padding-bottom: var(--spacing-sm);
            border-bottom: 2px solid #4d94ff;
        }

        
        .item-row:last-of-type {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        /* Metin Alanı Konteyneri */
        .text-area-container {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        /* Zorunlu alan başlığı - textarea içinde */
        .required-field-header {
            color: var(--accent-red);
            margin-bottom: 35px;
            margin-top: 35px;
            font-size: var(--font-size-xl);
            letter-spacing: 1.5px;
            text-shadow: 0 2px 5px var(--shadow-medium);
            text-align: center;
            text-transform: uppercase;
        }

        /* Checkbox Konteyneri */
        .checkbox-container {
            margin-right: var(--spacing-lg);
            padding-top: var(--spacing-lg);
            flex-shrink: 0;
        }
        
        .checkbox-container input[type="checkbox"] {
            transform: scale(2);
            accent-color: #3895ff;
            margin-top: 0;
            cursor: pointer;
        }

        /* Kolon Etiket Grubu */
        .column-label-group {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            min-width: 190px;
            margin-right: var(--spacing-lg);
            flex-shrink: 0;
        }
        
        .column-name {
            font-weight: 600;
            color: var(--text-secondary);
            font-size: var(--font-size-lg);
            margin-bottom: var(--spacing-xs);
        }
        
        .column-description {
            font-size: var(--font-size-sm);
            color: var(--text-muted);
            font-style: normal;
        }

        /* Metin Alanı Konteyneri */
        .text-area-container {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }
        
        textarea {
            width: 100%;
            min-height: 100px; /* Yükseklik artırıldı */
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius);
            box-sizing: border-box;
            resize: none; /* Yeniden boyutlandırma kapatıldı */
            font-size: 1em;
            line-height: 1.6;
            background-color: var(--bg-tertiary);
            color: var(--text-primary);
            box-shadow: inset 0 1px 3px var(--shadow-light);
            transition: border-color var(--transition-normal) ease, 
                       box-shadow var(--transition-normal) ease;
        }
        
        textarea::placeholder {
            color: var(--text-placeholder);
        }
        
        textarea:focus {
            outline: none;
            border-color: var(--accent-blue);
            box-shadow: 0 0 0 2px var(--focus-glow);
        }

        /* Hata durumunda textarea kenarlığı */
        textarea.error-border {
            border-color: var(--accent-red) !important;
            box-shadow: 0 0 0 2px rgba(248, 81, 73, 0.5) !important;
        }

        /* Ortak Checkbox Stilleri */
        .now-time-checkbox, .repeat-first-checkbox {
            margin-left: var(--spacing-xl);
            display: flex;
            align-items: center;
            white-space: nowrap;
            flex-shrink: 0;
        }
        
        .now-time-checkbox label, .repeat-first-checkbox label {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            cursor: pointer;
        }
        
        .now-time-checkbox input[type="checkbox"], 
        .repeat-first-checkbox input[type="checkbox"] {
            transform: scale(1.4);
            accent-color: var(--accent-red);
        }
        
        .now-time-checkbox span, .repeat-first-checkbox span {
            font-size: var(--font-size-md);
            color: var(--text-primary);
        }

        /* Ortak Buton Stilleri */
        .create-button, #copySqlBtn {
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-weight: 600;
            transition: background-color var(--transition-slow) ease, 
                       transform var(--transition-normal) ease, 
                       box-shadow var(--transition-normal) ease;
        }

        /* Ana Buton */
        .create-button {
            padding: 16px 35px;
            font-size: var(--font-size-xl);
            background-color: var(--accent-blue);
            color: white;
            box-shadow: 0 4px 10px #2b517e;
            margin-top: 30px;
            margin-left: 9cm;
        }
        
        .create-button:hover {
            background-color: var(--accent-blue-light);
            transform: translateY(-3px);
            box-shadow: 0 6px 6px var(--accent-blue-active);
        }
        
        .create-button:active {
            transform: translateY(0);
            background-color: var(--accent-blue-active);
            box-shadow: inset 0 2px 4px var(--shadow-medium);
        }

        /* SQL Çıktısı Alanı */
        #sqlOutputContainer {
            margin-top: 40px;
            background-color: var(--bg-tertiary);
            color: var(--text-secondary);
            font-family: var(--font-code);
            font-size: 0.9em;
            white-space: pre-wrap;
            word-break: break-all;
            position: relative;
            min-height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        #sqlOutput {
            /* max-height: 250px; */ /* Kaldırıldı, içeriğe göre büyüyecek */
            padding-top: var(--spacing-sm);
            width: 100%;
            box-sizing: border-box;
            color: var(--text-muted);
            font-style: italic;
            white-space: pre-wrap;
            overflow-wrap: break-word;
            text-align: left;
            padding-left: var(--spacing-sm);
            /* Çıktı alanının içeriğe göre büyümesini sağlamak için */
            overflow-y: auto; /* İçerik taşarsa kaydırma çubuğu */
            flex-grow: 1; /* Konteynerin içinde esnek büyüme */
        }

        /* Kopyala Butonu */
        #copySqlBtn {
            position: absolute;
            top: var(--spacing-md);
            right: var(--spacing-lg);
            background-color: var(--border-color);
            color: var(--text-secondary);
            padding: 8px 16px;
            font-size: 0.9em;
            z-index: 2;
            box-shadow: 0 2px 5px var(--shadow-light);
        }
        
        #copySqlBtn:hover {
            background-color: #586069;
            transform: translateY(-1px);
        }
        
        #copySqlBtn:active {
            transform: translateY(0);
            background-color: #3b424d;
            box-shadow: inset 0 1px 3px var(--shadow-medium);
        }

        /* Responsive Tasarım */
        @media (max-width: 768px) {
            .container, #sqlOutputContainer {
                width: 95%;
                padding: var(--spacing-lg);
            }
            
            h1 {
                font-size: 2em;
                margin-bottom: var(--spacing-xl);
            }
            
            .item-row {
                flex-direction: column;
                align-items: stretch;
            }
            
            .checkbox-container, .column-label-group, 
            .now-time-checkbox, .repeat-first-checkbox {
                margin-right: 0;
                margin-bottom: var(--spacing-sm);
                width: 100%;
            }
            
            .column-label-group {
                min-width: unset;
            }
            
            .text-area-container {
                margin-bottom: var(--spacing-md);
            }
            
            .now-time-checkbox, .repeat-first-checkbox {
                margin-left: 0;
                justify-content: flex-start;
            }
            
            .create-button {
                width: 100%;
                padding: 14px var(--spacing-lg);
                font-size: 1.1em;
            }

            .platesub {
            color: var(--accent-red);
            margin-bottom: 35px;
            margin-top: 35px;
            font-size: var(--font-size-xl);
            letter-spacing: 1.5px;
            text-shadow: 0 2px 5px var(--shadow-medium);
            text-align: center;
            }
            
            .red-line {
                border: none;
                height: 2px;
                background-color: var(--accent-red);
                margin: 20px 0;
                width: 100%;         /* Tam genişlikte çizgi */
                align-self: stretch; /* Flex konteynerde tam genişlik */
            }


            #copySqlBtn {
                position: static;
                width: 100%;
                margin-top: var(--spacing-md);
                margin-bottom: var(--spacing-sm);
                text-align: center;
            }
            
            #sqlOutput {
                max-height: 180px;
            }

        }

        /* New CSS for Mode Switch */
        .mode-switch-container {
            margin-bottom: 20px;
            text-align: center;
            padding: var(--spacing-md);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            background-color: var(--bg-tertiary);
            display: flex;
            justify-content: center;
            gap: 30px; /* Space between radio buttons */
            box-shadow: inset 0 1px 3px var(--shadow-light);
        }

        .mode-switch-container label {
            display: flex;
            align-items: center;
            cursor: pointer;
            color: var(--text-secondary);
            font-size: var(--font-size-lg);
            gap: 10px; /* Space between radio input and text */
            transition: color var(--transition-normal) ease;
        }

        .mode-switch-container label:hover {
            color: var(--accent-blue);
        }

        .mode-switch-container input[type="radio"] {
            /* Basic styling for radio buttons */
            appearance: none; /* Remove default radio button styles */
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border: 2px solid var(--border-color);
            border-radius: 50%;
            background-color: var(--bg-secondary);
            position: relative;
            cursor: pointer;
            outline: none;
            transition: border-color var(--transition-normal) ease, background-color var(--transition-normal) ease;
        }

        .mode-switch-container input[type="radio"]:checked {
            border-color: var(--accent-blue);
            background-color: var(--accent-blue);
        }

        .mode-switch-container input[type="radio"]:checked::before {
            content: '';
            display: block;
            width: 10px;
            height: 10px;
            background-color: white;
            border-radius: 50%;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

    </style>
</head>
<body>

    <h1 class="platesub">Whitelist Inserter/Deleter</h1>

    <div class="mode-switch-container">
        <label>
            <input type="radio" id="insertMode" name="mode" value="insert" checked> Insert Mode
        </label>
        <label>
            <input type="radio" id="deleteMode" name="mode" value="delete"> Delete Mode
        </label>
    </div>

<div class="container">
    <div class="info-notes">
        <p class="red-note">Not: Excel'den kopyalanan her satır, sistem tarafından ayrı bir INSERT komutu olarak işlenir. Lütfen verileri satır satır yapıştırınız ve tüm satırların aynı sayıda veri içerdiğinden emin olunuz.</p>
        <p class="orange-note">created_at, created_by_id, park_id, description gibi sabit alanlar tek bir satır olarak girilebilir; bu değerler, diğer tüm verilerle birlikte otomatik olarak her INSERT komutuna dahil edilecektir.</p>
    </div>

        <h4 class="required-field-header">zorunlu alan</h4>

    <div style="display: flex;align-items: flex-start;padding-top: 20px; margin-bottom: 50px;padding-bottom: 20px;border-bottom: 3px solid #ff4d4d;border-top:  3px solid #ff4d4d;">
        <div class="checkbox-container">
            <input type="checkbox" id="plate_check" checked disabled>
        </div>
        <div class="column-label-group">
            <div class="column-name">plate</div>
            <div class="column-description">(Plaka)</div>
        </div>
        <div class="text-area-container">
            <textarea id="plate_text" placeholder="Örn: 34GTY132"></textarea>
        </div>
    </div>
    <div class="item-row" style="padding-top: 10px; border-top: 2px solid #4d94ff;">
        <div class="checkbox-container">
            <input type="checkbox" id="created_by_id_check" disabled checked>
        </div>
        <div class="column-label-group">
            <div class="column-name">created_by_id</div>
            <div class="column-description">(Oluşturan kişi ID)</div>
        </div>
        <div class="text-area-container">
            <textarea id="created_by_id_text" placeholder="Örn: 10675"></textarea>
        </div>
        <div class="repeat-first-checkbox">
            <label>
                <input type="checkbox" id="created_by_id_repeat_check" checked>
                <span>İlk Satırı Tekrarla</span>
            </label>
        </div>
    </div>

    <div class="item-row">
        <div class="checkbox-container">
            <input type="checkbox" id="park_id_check" disabled checked>
        </div>
        <div class="column-label-group">
            <div class="column-name">park_id</div>
            <div class="column-description">(Parkın ID'si)</div>
        </div>
        <div class="text-area-container">
            <textarea id="park_id_text" placeholder="Örn: 77"></textarea>
        </div>
        <div class="repeat-first-checkbox">
            <label>
                <input type="checkbox" id="park_id_repeat_check" checked>
                <span>İlk Satırı Tekrarla</span>
            </label>
        </div>
    </div>

    <div class="item-row">
        <div class="checkbox-container">
            <input type="checkbox" id="created_at_check" disabled checked>
        </div>
        <div class="column-label-group">
            <div class="column-name">created_at</div>
            <div class="column-description"></div>
        </div>
        <div class="text-area-container">
            <textarea id="created_at_text" placeholder="YYYY-MM-DD HH:MM:SS formatında giriniz..."></textarea>
        </div>
        <div class="now-time-checkbox">
            <label>
                <input type="checkbox" id="created_at_now_check">
                <span>Şimdiki Zaman</span>
            </label>
        </div>
    </div>

    <div class="item-row">
        <div class="checkbox-container">
            <input type="checkbox" id="expiry_at_check">
        </div>
        <div class="column-label-group">
            <div class="column-name">expiry_at</div>
            <div class="column-description">(Geçerlilik Tarihi)</div>
        </div>
        <div class="text-area-container">
            <textarea id="expiry_at_text" placeholder="YYYY-MM-DD HH:MM:SS formatında giriniz..."></textarea>
        </div>
        <div class="now-time-checkbox">
            <label>
                <input type="checkbox" id="expiry_at_now_check">
                <span>Şimdiki Zaman</span>
            </label>
        </div>
    </div>

    <div class="item-row">
        <div class="checkbox-container">
            <input type="checkbox" id="name_check">
        </div>
        <div class="column-label-group">
            <div class="column-name">name</div>
            <div class="column-description">(Müşteri Adı)</div>
        </div>
        <div class="text-area-container">
            <textarea id="name_text" placeholder="Örn: EMRE"></textarea>
        </div>
        <div class="repeat-first-checkbox">
            <label>
                <input type="checkbox" id="name_repeat_check"> <span>İlk Satırı Tekrarla</span>
            </label>
        </div>
    </div>

    <div class="item-row">
        <div class="checkbox-container">
            <input type="checkbox" id="company_name_check">
        </div>
        <div class="column-label-group">
            <div class="column-name">company_name</div>
            <div class="column-description">(Şirket Adı)</div>
        </div>
        <div class="text-area-container">
            <textarea id="company_name_text" placeholder="Örn: 4B PLAZA"></textarea>
        </div>
        <div class="repeat-first-checkbox">
            <label>
                <input type="checkbox" id="company_name_repeat_check"> <span>İlk Satırı Tekrarla</span>
            </label>
        </div>
    </div>
    <div class="item-row">
        <div class="checkbox-container">
            <input type="checkbox" id="description_check">
        </div>
        <div class="column-label-group">
            <div class="column-name">description</div>
            <div class="column-description">(Açıklama)</div>
        </div>
        <div class="text-area-container">
            <textarea id="description_text" placeholder="Örn: Malik"></textarea>
        </div>
        <div class="repeat-first-checkbox">
            <label>
                <input type="checkbox" id="description_repeat_check"> <span>İlk Satırı Tekrarla</span>
            </label>
        </div>
    </div>

    <div class="item-row">
        <div class="checkbox-container">
            <input type="checkbox" id="payment_status_check">
        </div>
        <div class="column-label-group">
            <div class="column-name">payment_status</div>
            <div class="column-description">(Ödeme Durumu)</div>
        </div>
        <div class="text-area-container">
            <textarea id="payment_status_text" placeholder="Örn: Ücretsiz: 1 || Ödenmiş: 2 || Ödememiş: 3"></textarea>
        </div>
        <div class="repeat-first-checkbox">
            <label>
                <input type="checkbox" id="payment_status_repeat_check"> <span>İlk Satırı Tekrarla</span>
            </label>
        </div>
    </div>

    <div class="item-row">
        <div class="checkbox-container">
            <input type="checkbox" id="phone_check">
        </div>
        <div class="column-label-group">
            <div class="column-name">phone</div>
            <div class="column-description">(Telefon Numarası)</div>
        </div>
        <div class="text-area-container">
            <textarea id="phone_text" placeholder="Örn: 5551234567"></textarea>
        </div>
        <div class="repeat-first-checkbox">
            <label>
                <input type="checkbox" id="phone_repeat_check"> <span>İlk Satırı Tekrarla</span>
            </label>
        </div>
    </div>

    <div class="item-row">
        <div class="checkbox-container">
            <input type="checkbox" id="payment_amount_check">
        </div>
        <div class="column-label-group">
            <div class="column-name">payment_amount</div>
            <div class="column-description">(Ödeme Miktarı)</div>
        </div>
        <div class="text-area-container">
            <textarea id="payment_amount_text" placeholder="Örn: 15.75"></textarea>
        </div>
        <div class="repeat-first-checkbox">
            <label>
                <input type="checkbox" id="payment_amount_repeat_check"> <span>İlk Satırı Tekrarla</span>
            </label>
        </div>
    </div>

    <button class="create-button" id="createButton">SQL Sorgusu Oluştur</button>
</div>

<div id="sqlOutputContainer">
    <button id="copySqlBtn" title="Kopyala">Kopyala</button>
    <pre id="sqlOutput">Veri giriniz.</pre>
</div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const createButton = document.getElementById('createButton');
            const sqlOutput = document.getElementById('sqlOutput');
            const copySqlBtn = document.getElementById('copySqlBtn');

            // NEW: Mode switch elements
            const insertModeRadio = document.getElementById('insertMode');
            const deleteModeRadio = document.getElementById('deleteMode');

            let currentMode = 'insert'; // Default mode

            // Kopyala butonu işlevi
            if (copySqlBtn) {
                copySqlBtn.addEventListener('click', () => {
                    const sql = sqlOutput.textContent;
                    if (sql && sql.trim() !== "" && sql !== "Veri giriniz." && !sql.startsWith("Hata:")) {
                        // Geçici bir textarea oluştur
                        const tempTextArea = document.createElement('textarea');
                        tempTextArea.value = sql;
                        document.body.appendChild(tempTextArea);
                        tempTextArea.select(); // Metni seç
                        document.execCommand('copy'); // Kopyala
                        document.body.removeChild(tempTextArea); // Geçici textarea'yı kaldır

                        copySqlBtn.textContent = "Kopyalandı!";
                        setTimeout(() => { copySqlBtn.textContent = "Kopyala"; }, 1200);
                    }
                });
            }

            // Alanların konfigürasyonu ve varsayılan durumları
            const fieldsConfig = {
                created_at: { checkboxId: 'created_at_check', textareaId: 'created_at_text', type: 'datetime', special: 'now_datetime', placeholder: 'YYYY-MM-DD HH:MM:SS formatında giriniz...', mandatory: true },
                created_by_id: { checkboxId: 'created_by_id_check', textareaId: 'created_by_id_text', type: 'int', hasRepeatOption: true, placeholder: 'Örn: 10675', mandatory: true },
                park_id: { checkboxId: 'park_id_check', textareaId: 'park_id_text', type: 'int', hasRepeatOption: true, placeholder: 'Örn: 77', mandatory: true },
                plate: { checkboxId: 'plate_check', textareaId: 'plate_text', type: 'varchar(255)', multiLine: true, placeholder: 'Örn: 34GTY132', mandatory: true }, // Plate her zaman zorunlu ve tikli
                
                // Zorunlu olmayan alanlar (varsayılan olarak unchecked)
                expiry_at: { checkboxId: 'expiry_at_check', textareaId: 'expiry_at_text', type: 'datetime', special: 'now_datetime', placeholder: 'YYYY-MM-DD HH:MM:SS formatında giriniz...', mandatory: false }, 
                name: { checkboxId: 'name_check', textareaId: 'name_text', type: 'varchar(255)', hasRepeatOption: true, placeholder: 'Örn: EMRE', mandatory: false }, 
                company_name: { checkboxId: 'company_name_check', textareaId: 'company_name_text', type: 'varchar(255)', hasRepeatOption: true, placeholder: 'Örn: 4B PLAZA', mandatory: false }, 
                description: { checkboxId: 'description_check', textareaId: 'description_text', type: 'text', hasRepeatOption: true, placeholder: 'Örn: Malik', mandatory: false }, 
                payment_status: { checkboxId: 'payment_status_check', textareaId: 'payment_status_text', type: 'int', hasRepeatOption: true, placeholder: 'Örn: 1 (Ödendi), 0 (Ödenmedi)', mandatory: false }, 
                phone: { checkboxId: 'phone_check', textareaId: 'phone_text', type: 'varchar(255)', hasRepeatOption: true, placeholder: 'Örn: 5551234567', mandatory: false }, 
                payment_amount: { checkboxId: 'payment_amount_check', textareaId: 'payment_amount_text', type: 'double(11,2)', hasRepeatOption: true, placeholder: 'Örn: 15.75', mandatory: false }, 
                
                // Güncel kodda olmayan ancak fieldsConfig'de tanımlı olabilecekler (örnek olarak bırakıldı)
                updated_at: { checkboxId: 'updated_at_check', textareaId: 'updated_at_text', type: 'datetime', special: 'now_datetime', placeholder: 'YYYY-MM-DD HH:MM:SS formatında giriniz...', mandatory: false }, 
                updated_by_id: { checkboxId: 'updated_by_id_check', textareaId: 'updated_by_id_text', type: 'int', hasRepeatOption: true, placeholder: 'Örn: 10675', mandatory: false }, 
                company: { checkboxId: 'company_check', textareaId: 'company_text', type: 'varchar(255)', hasRepeatOption: true, placeholder: 'Örn: A.Ş.', mandatory: false } 
            };

            // SQL string değerlerini kaçış karakterleriyle düzenleme fonksiyonu
            function escapeSqlString(str) {
                if (typeof str !== 'string') {
                    return str; // String değilse olduğu gibi döndür
                }
                return str.replace(/'/g, "''"); // Tek tırnakları çift tırnak yapar
            }

            // Tarih formatı doğrulama regex'i (YYYY-MM-DD HH:MM:SS)
            const datetimeRegex = /^\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}$/;

            // Hata mesajını gösteren ve ilgili alana kaydıran yardımcı fonksiyon
            function showErrorAndScroll(message, element) {
                sqlOutput.textContent = `Hata: ${message}`;
                sqlOutput.style.color = 'var(--accent-red)';
                if (element) {
                    element.classList.add('error-border');
                    element.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            }

            // Tüm textarea'lardan hata kenarlıklarını temizleyen fonksiyon
            function clearAllErrorBorders() {
                for (const fieldName in fieldsConfig) {
                    const textarea = document.getElementById(fieldsConfig[fieldName].textareaId);
                    if (textarea) {
                        textarea.classList.remove('error-border');
                    }
                }
            }

            // Function to update UI based on mode
            function updateUIMode() {
                if (currentMode === 'insert') {
                    // Show insert-specific elements, hide delete-specific ones if any
                    // Adjust mandatory fields or repeat options as needed for insert mode
                    // (Current setup is already for insert, so minimal changes here)
                    document.querySelector('.create-button').textContent = "SQL Sorgusu Oluştur";
                    // Re-enable/disable checkboxes and repeat options based on insert config
                    for (const fieldName in fieldsConfig) {
                        const config = fieldsConfig[fieldName];
                        const checkbox = document.getElementById(config.checkboxId);
                        const repeatCheckbox = config.hasRepeatOption ? document.getElementById(fieldName + '_repeat_check') : null;
                        const nowCheckbox = config.special === 'now_datetime' ? document.getElementById(fieldName + '_now_check') : null;

                        if (checkbox) {
                            checkbox.checked = config.mandatory;
                            checkbox.disabled = config.mandatory;
                        }
                        if (repeatCheckbox) {
                            repeatCheckbox.checked = (fieldName === 'created_by_id' || fieldName === 'park_id'); // Default for insert
                            repeatCheckbox.closest('.repeat-first-checkbox').style.display = 'flex'; // Show repeat option
                        }
                        if (nowCheckbox) {
                            nowCheckbox.checked = false;
                            nowCheckbox.closest('.now-time-checkbox').style.display = 'flex'; // Show now option
                        }
                    }
                } else if (currentMode === 'delete') {
                    // Hide insert-specific elements (e.g., repeat options, now time for certain fields)
                    // Show delete-specific elements if any (e.g., "delete by similar value" checkbox)
                    document.querySelector('.create-button').textContent = "SQL Silme Sorgusu Oluştur";
                    // For delete mode, all checkboxes should be enabled and unchecked by default
                    // And repeat/now options might be hidden or behave differently
                    for (const fieldName in fieldsConfig) {
                        const config = fieldsConfig[fieldName];
                        const checkbox = document.getElementById(config.checkboxId);
                        const repeatCheckbox = config.hasRepeatOption ? document.getElementById(fieldName + '_repeat_check') : null;
                        const nowCheckbox = config.special === 'now_datetime' ? document.getElementById(fieldName + '_now_check') : null;

                        if (checkbox) {
                            checkbox.checked = false; // All unchecked by default for delete
                            checkbox.disabled = false; // All enabled for delete criteria selection
                        }
                        if (repeatCheckbox) {
                            repeatCheckbox.closest('.repeat-first-checkbox').style.display = 'none'; // Hide repeat for delete
                        }
                        if (nowCheckbox) {
                            nowCheckbox.closest('.now-time-checkbox').style.display = 'none'; // Hide now for delete
                        }
                    }
                    // Plate should not be mandatory for delete, user chooses criteria
                    document.getElementById('plate_check').checked = false;
                    document.getElementById('plate_check').disabled = false;
                }
                sqlOutput.textContent = "Veri giriniz."; // Reset output
                sqlOutput.style.color = 'var(--text-muted)';
                clearAllErrorBorders();
            }

            // Event listeners for mode switch
            if (insertModeRadio) {
                insertModeRadio.addEventListener('change', () => {
                    currentMode = 'insert';
                    updateUIMode();
                });
            }
            if (deleteModeRadio) {
                deleteModeRadio.addEventListener('change', () => {
                    currentMode = 'delete';
                    updateUIMode();
                });
            }

            // Existing generateInsertSql function (extracted from createButton logic)
            function generateInsertSql() {
                // --- Your existing INSERT logic goes here ---
                // This is the code currently inside your createButton.addEventListener for the 'insert' mode.
                // Make sure it returns the generated SQL string or null/error message.

                clearAllErrorBorders();
                sqlOutput.textContent = "Veri giriniz.";
                sqlOutput.style.color = 'var(--text-muted)';

                let columnsToInclude = new Set();
                let allRowsData = [];
                let plateLines = [];
                let hasValidationError = false;
                let firstErrorElement = null;

                const plateTextarea = document.getElementById(fieldsConfig.plate.textareaId);
                let rawPlateLines = plateTextarea.value.split(/\r?\n/).map(line => line.trim());

                while (rawPlateLines.length > 0 && (rawPlateLines[rawPlateLines.length - 1] === '' || rawPlateLines[rawPlateLines.length - 1] === '-')) {
                    rawPlateLines.pop();
                }

                if (rawPlateLines.length === 0) {
                    showErrorAndScroll("Plaka alanı zorunludur ve boş bırakılamaz.", plateTextarea);
                    return null; // Return null to indicate error
                }
                plateLines = rawPlateLines;
                const plateLinesCount = plateLines.length;

                for (let i = 0; i < plateLinesCount; i++) {
                    let currentRowValues = {};

                    for (const fieldName in fieldsConfig) {
                        const config = fieldsConfig[fieldName];
                        const checkbox = document.getElementById(config.checkboxId);
                        const textarea = document.getElementById(config.textareaId);
                        const repeatCheckbox = config.hasRepeatOption ? document.getElementById(fieldName + '_repeat_check') : null;
                        const nowCheckbox = config.special === 'now_datetime' ? document.getElementById(fieldName + '_now_check') : null;

                        let valueToProcess = null;
                        let isFieldChecked = checkbox && checkbox.checked;
                        let isMandatory = config.mandatory;
                        let isSpecialOptionChecked = (nowCheckbox && nowCheckbox.checked) || (repeatCheckbox && repeatCheckbox.checked);
                        let isSqlFunction = false;

                        if (isFieldChecked) {
                            columnsToInclude.add(fieldName);

                            let currentLineValue = '';
                            if (fieldName === 'plate') {
                                valueToProcess = plateLines[i];
                                if (valueToProcess === '') {
                                    showErrorAndScroll(`Plaka alanı (satır ${i + 1}) zorunludur ve boş bırakılamaz.`, plateTextarea);
                                    hasValidationError = true;
                                    if (!firstErrorElement) firstErrorElement = plateTextarea;
                                    break;
                                }
                            } else if (isSpecialOptionChecked) {
                                if (nowCheckbox && nowCheckbox.checked) {
                                    valueToProcess = 'NOW()';
                                    isSqlFunction = true;
                                } else if (repeatCheckbox && repeatCheckbox.checked) {
                                    const firstLineValueRaw = textarea.value.split(/\r?\n/)[0]?.trim() || '';
                                    const firstLineValue = (firstLineValueRaw === '' || firstLineValueRaw === '-') ? '' : firstLineValueRaw;

                                    if (firstLineValue === '') {
                                        showErrorAndScroll(`${config.placeholder.split(':')[0]} alanı için 'İlk Satırı Tekrarla' seçeneği işaretli ancak ilk satır boş bırakılamaz.`, textarea);
                                        hasValidationError = true;
                                        if (!firstErrorElement) firstErrorElement = textarea;
                                        break;
                                    }
                                    valueToProcess = firstLineValue;
                                }
                            } else {
                                const allLines = textarea.value.split(/\r?\n/).map(line => line.trim());
                                let effectiveValueForThisRow = '';

                                if (allLines.length === 1) {
                                    effectiveValueForThisRow = allLines[0];
                                } else if (allLines.length > 1 && allLines.length !== plateLinesCount) {
                                    showErrorAndScroll(`${config.placeholder.split(':')[0]} alanı için girilen satır sayısı (${allLines.length}), plaka satır sayısı (${plateLinesCount}) ile eşleşmiyor.`, textarea);
                                    hasValidationError = true;
                                    if (!firstErrorElement) firstErrorElement = textarea;
                                    break;
                                } else {
                                    effectiveValueForThisRow = allLines[i] || '';
                                }

                                if (effectiveValueForThisRow === '-' || effectiveValueForThisRow === '') {
                                    effectiveValueForThisRow = '';
                                }

                                if (fieldName === 'created_at' && !nowCheckbox.checked && effectiveValueForThisRow === '') {
                                    showErrorAndScroll(`${config.placeholder.split(':')[0]} alanı zorunludur ve boş bırakılamaz.`, textarea);
                                    hasValidationError = true;
                                    if (!firstErrorElement) firstErrorElement = textarea;
                                    break;
                                } else if (config.type === 'datetime' && effectiveValueForThisRow.toLowerCase() === 'limitsiz') {
                                    valueToProcess = 'NULL';
                                } else if (isMandatory && effectiveValueForThisRow === '') {
                                    showErrorAndScroll(`${config.placeholder.split(':')[0]} alanı zorunludur ve boş bırakılamaz.`, textarea);
                                    hasValidationError = true;
                                    if (!firstErrorElement) firstErrorElement = textarea;
                                    break;
                                } else if (!isMandatory && effectiveValueForThisRow === '') {
                                    valueToProcess = 'NULL';
                                } else {
                                    valueToProcess = effectiveValueForThisRow;
                                }
                            }

                            if (textarea) {
                                textarea.classList.remove('error-border');
                            }

                            if (fieldName === 'description' && isFieldChecked) {
                                if (valueToProcess === 'NULL' || valueToProcess === '') {
                                    valueToProcess = `DATE_FORMAT(NOW(), '%Y-%m-%d')`;
                                } else {
                                    valueToProcess = `CONCAT('${escapeSqlString(valueToProcess)} ', DATE_FORMAT(NOW(), '%Y-%m-%d'))`;
                                }
                                isSqlFunction = true;
                            }

                            if (!isSqlFunction) {
                                if (valueToProcess === 'NULL') {
                                    // Do nothing
                                } else if (config.type.startsWith('varchar') || config.type === 'text' || config.type === 'datetime') {
                                    valueToProcess = `'${escapeSqlString(valueToProcess)}'`;
                                } else if (config.type.startsWith('int')) {
                                    valueToProcess = parseInt(valueToProcess, 10);
                                    if (isNaN(valueToProcess)) valueToProcess = 'NULL';
                                } else if (config.type.startsWith('double')) {
                                    valueToProcess = parseFloat(valueToProcess.replace(',', '.'));
                                    if (isNaN(valueToProcess)) valueToProcess = 'NULL';
                                }
                            }
                            currentRowValues[fieldName] = valueToProcess;
                        } else {
                            if (textarea) {
                                textarea.classList.remove('error-border');
                            }
                        }
                    }

                    if (hasValidationError) {
                        return null;
                    }
                    allRowsData.push(currentRowValues);
                }

                if (hasValidationError) {
                    return null;
                }

                const desiredOrder = [
                    'created_at', 'created_by_id', 'updated_at', 'updated_by_id', 'plate', 'park_id',
                    'description', 'expiry_at', 'payment_status', 'phone', 'payment_amount',
                    'name', 'company', 'company_name'
                ];

                const finalSortedColumns = desiredOrder.filter(col => columnsToInclude.has(col));

                if (finalSortedColumns.length === 0) {
                    showErrorAndScroll("Oluşturulacak geçerli bir alan bulunamadı. Lütfen en az bir alan seçin ve doldurun.", null);
                    return null;
                }

                let allValuesStrings = [];
                allRowsData.forEach(rowData => {
                    const valuesForThisRow = finalSortedColumns.map(col => {
                        return rowData[col] !== undefined ? rowData[col] : 'NULL';
                    });
                    allValuesStrings.push(`(${valuesForThisRow.join(', ')})`);
                });

                return `INSERT INTO default_parking_whitelist\n\t(${finalSortedColumns.join(', ')})\nVALUES\n\t${allValuesStrings.join(',\n\t')};`;
            }

            // NEW: Function to generate DELETE SQL
            function generateDeleteSql() {
                clearAllErrorBorders(); // Clear previous errors
                let whereClauses = [];
                let hasError = false;
                let firstErrorElement = null;

                // Iterate through all fields to see which are checked and have values
                for (const fieldName in fieldsConfig) {
                    const config = fieldsConfig[fieldName];
                    const checkbox = document.getElementById(config.checkboxId);
                    const textarea = document.getElementById(config.textareaId);

                    if (checkbox && checkbox.checked) {
                        const rawValues = textarea.value.split(/\r?\n/).map(line => line.trim()).filter(line => line !== '' && line !== '-');

                        if (rawValues.length === 0) {
                            showErrorAndScroll(`Silme işlemi için seçilen '${config.placeholder.split(':')[0]}' alanı boş bırakılamaz.`, textarea);
                            hasError = true;
                            if (!firstErrorElement) firstErrorElement = textarea;
                            break;
                        }

                        // Handle "similar values" (using LIKE for strings, IN for multiple exact matches)
                        if (config.type.startsWith('varchar') || config.type === 'text') {
                            // For string types, consider if "similar" means LIKE or IN
                            // For simplicity, let's assume multiple lines mean OR conditions with LIKE
                            const likeConditions = rawValues.map(val => `${fieldName} LIKE '%${escapeSqlString(val)}%'`);
                            whereClauses.push(`(${likeConditions.join(' OR ')})`);
                        } else {
                            // For numeric or datetime types, exact match is more common, use IN for multiple values
                            const values = rawValues.map(val => {
                                if (config.type.startsWith('int')) {
                                    const num = parseInt(val, 10);
                                    return isNaN(num) ? 'NULL' : num;
                                } else if (config.type.startsWith('double')) {
                                    const num = parseFloat(val.replace(',', '.'));
                                    return isNaN(num) ? 'NULL' : num;
                                } else if (config.type === 'datetime') {
                                    if (val.toLowerCase() === 'limitsiz') {
                                        return 'NULL';
                                    }
                                    // Basic datetime format validation, can be more robust
                                    if (!datetimeRegex.test(val)) {
                                        showErrorAndScroll(`'${config.placeholder.split(':')[0]}' alanı için geçersiz tarih/saat formatı: '${val}'. YYYY-MM-DD HH:MM:SS formatında giriniz.`, textarea);
                                        hasError = true;
                                        if (!firstErrorElement) firstErrorElement = textarea;
                                        return; // Stop processing this field
                                    }
                                    return `'${escapeSqlString(val)}'`;
                                }
                                return `'${escapeSqlString(val)}'`; // Fallback for other types
                            }).filter(val => val !== undefined); // Filter out undefined values from validation errors

                            if (hasError) break; // If a format error occurred, stop

                            if (values.length > 0) {
                                // Handle NULL specifically
                                const nonNullValues = values.filter(v => v !== 'NULL');
                                const nullCount = values.filter(v => v === 'NULL').length;

                                let fieldConditions = [];
                                if (nonNullValues.length > 0) {
                                    fieldConditions.push(`${fieldName} IN (${nonNullValues.join(', ')})`);
                                }
                                if (nullCount > 0) {
                                    fieldConditions.push(`${fieldName} IS NULL`);
                                }
                                if (fieldConditions.length > 0) {
                                     whereClauses.push(`(${fieldConditions.join(' OR ')})`);
                                }
                            }
                        }
                    }
                }

                if (hasError) {
                    return null; // Stop if there was a validation error
                }

                if (whereClauses.length === 0) {
                    showErrorAndScroll("Silme işlemi için en az bir kriter seçilmeli ve doldurulmalıdır.", null);
                    return null;
                }

                return `DELETE FROM default_parking_whitelist\nWHERE\n\t${whereClauses.join('\n\tAND ')};`;
            }


            // Main button click handler
            createButton.addEventListener('click', () => {
                if (currentMode === 'insert') {
                    const sql = generateInsertSql();
                    if (sql) {
                        sqlOutput.textContent = sql;
                        sqlOutput.style.color = 'var(--text-secondary)';
                    }
                } else if (currentMode === 'delete') {
                    const sql = generateDeleteSql();
                    if (sql) {
                        sqlOutput.textContent = sql;
                        sqlOutput.style.color = 'var(--accent-red)'; // Red color for delete SQL
                    }
                }
            });

            // Initialize UI mode on load
            updateUIMode();
        });
    </script>

</body>
</html>