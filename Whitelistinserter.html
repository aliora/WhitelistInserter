<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Whitelist Inserter</title>
    <style>
        /* CSS Değişkenleri - Tekrar Eden Değerler */
        :root {
            /* Renkler */
            --bg-primary: #22272e;
            --bg-secondary: #2d333b;
            --bg-tertiary: #1c2128;
            --border-color: #444c56;
            --text-primary: #adbac7;
            --text-secondary: #c9d1d9;
            --text-muted: #8b949e;
            --text-placeholder: #6e7681;
            --accent-blue: #58a6ff;
            --accent-blue-light: #a1cdff;
            --accent-blue-active: #63acff;
            --accent-red: #f85149;
            --accent-orange: #e3b341;
            --shadow-light: rgba(0,0,0,0.2);
            --shadow-medium: rgba(0,0,0,0.3);
            --focus-glow: rgba(88,166,255,0.3);
            
            /* Boyutlar */
            --container-width: 90%;
            --container-max-width: 950px;
            --border-radius: 8px;
            --border-radius-large: 12px;
            --spacing-xs: 5px;
            --spacing-sm: 10px;
            --spacing-md: 15px;
            --spacing-lg: 20px;
            --spacing-xl: 25px;
            --spacing-xxl: 30px;
            
            /* Tipografi */
            --font-primary: 'Inter', sans-serif;
            --font-code: 'Fira Code', 'Consolas', 'Monaco', monospace;
            --font-size-sm: 0.85em;
            --font-size-md: 0.95em;
            --font-size-lg: 1.15em;
            --font-size-xl: 1.2em;
            --font-size-xxl: 2.5em;
            
            /* Geçişler */
            --transition-fast: 0.1s;
            --transition-normal: 0.2s;
            --transition-slow: 0.3s;
        }

        /* Genel Stil ve Koyu Tema Ayarları */
        body {
            font-family: var(--font-primary);
            margin: 0;
            padding: var(--spacing-lg);
            background-color: var(--bg-primary);
            color: var(--text-primary);
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            box-sizing: border-box;
        }

        h1 {
            color: var(--text-secondary);
            margin-bottom: 35px;
            font-size: var(--font-size-xxl);
            letter-spacing: 1.5px;
            text-shadow: 0 2px 5px var(--shadow-medium);
            text-align: center;
        }

        /* Ortak Konteyner Stilleri */
        .container, #sqlOutputContainer {
            width: var(--container-width);
            max-width: var(--container-max-width);
            background-color: var(--bg-secondary);
            padding: var(--spacing-xxl);
            border-radius: var(--border-radius-large);
            box-shadow: 0 8px 20px var(--shadow-medium);
            border: 1px solid var(--border-color);
        }

        .container {
            margin-bottom: 40px;
        }

        /* Bilgi Notları */
        .info-notes {
            margin-bottom: var(--spacing-xl);
            padding-bottom: var(--spacing-xl);
            border-bottom: 1px solid var(--border-color);
        }
        
        .info-notes p {
            font-size: var(--font-size-md);
            line-height: 1.6;
            margin-bottom: var(--spacing-sm);
        }
        
        .info-notes p:last-child {
            margin-bottom: 0;
        }
        
        .info-notes .red-note {
            color: var(--accent-red);
            font-weight: bold;
        }
        
        .info-notes .orange-note {
            color: var(--accent-orange);
        }

        /* Her Bir Alan Satırı */
        .item-row {
            display: flex;
            align-items: flex-start; /* Başlangıca hizalama */
            margin-bottom: var(--spacing-sm);
            padding-bottom: var(--spacing-sm);
            border-bottom: 2px solid #4d94ff;
        }

        .item-row:last-of-type {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        /* Metin Alanı Konteyneri */
        .text-area-container {
            flex-grow: 1; /* Mevcut alanda esnek büyüme */
            display: flex;
            flex-direction: column;
        }

        /* Zorunlu alan başlığı - textarea içinde */
        .required-field-header {
            color: var(--accent-red);
            margin-bottom: 35px;
            margin-top: 35px;
            font-size: var(--font-size-xl);
            letter-spacing: 1.5px;
            text-shadow: 0 2px 5px var(--shadow-medium);
            text-align: center;
            text-transform: uppercase;
        }

        /* Checkbox Konteyneri (Ana tikler için) */
        .checkbox-container {
            margin-right: var(--spacing-lg);
            padding-top: var(--spacing-lg);
            flex-shrink: 0; /* Küçülmesini engelle */
        }
        
        .checkbox-container input[type="checkbox"] {
            transform: scale(2);
            accent-color: #3895ff;
            margin-top: 0;
            cursor: pointer;
        }

        /* Kolon Etiket Grubu */
        .column-label-group {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            min-width: 190px;
            margin-right: var(--spacing-lg);
            flex-shrink: 0; /* Küçülmesini engelle */
        }
        
        .column-name {
            font-weight: 600;
            color: var(--text-secondary);
            font-size: var(--font-size-lg);
            margin-bottom: var(--spacing-xs);
        }
        
        .column-description {
            font-size: var(--font-size-sm);
            color: var(--text-muted);
            font-style: normal;
        }

        /* Metin Alanı ve Seçenekleri Sarmalayıcısı */
        .content-and-options-wrapper {
            flex-grow: 1; /* Kalan tüm alanı kaplar */
            display: flex; /* İçindekileri yatay sırala */
            align-items: flex-start; /* Dikeyde başlangıca hizala */
        }
        
        textarea {
            width: 100%;
            min-height: 100px; /* Yükseklik artırıldı */
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius);
            box-sizing: border-box;
            resize: none; /* Yeniden boyutlandırma kapatıldı */
            font-size: 1em;
            line-height: 1.6;
            background-color: var(--bg-tertiary);
            color: var(--text-primary);
            box-shadow: inset 0 1px 3px var(--shadow-light);
            transition: border-color var(--transition-normal) ease, 
                       box-shadow var(--transition-normal) ease;
        }
        
        textarea::placeholder {
            color: var(--text-placeholder);
        }
        
        textarea:focus {
            outline: none;
            border-color: var(--accent-blue);
            box-shadow: 0 0 0 2px var(--focus-glow);
        }

        /* Hata durumunda textarea kenarlığı */
        textarea.error-border {
            border-color: var(--accent-red) !important;
            box-shadow: 0 0 0 2px rgba(248, 81, 73, 0.5) !important;
        }

        /* Checkbox Seçenekleri Grubu (Metin kutusunun sağında dikey hizalanır) */
        .checkbox-options-group {
            display: flex;
            flex-direction: column; /* İçindeki checkbox'ları dikey sırala */
            gap: var(--spacing-sm); /* Aralarında boşluk bırak */
            margin-left: var(--spacing-xl); /* Metin kutusu ile arasında boşluk */
            flex-shrink: 0; /* Küçülmesini engelle */
            padding-top: var(--spacing-lg); /* Checkbox'ları metin kutusunun tepesiyle hizala */
        }

        /* Ortak Özel Checkbox Stilleri (Şimdiki Zaman, İlk Satırı Tekrarla, Giriş Tipi) */
        .now-time-checkbox, 
        .repeat-first-checkbox,
        .input-type-checkbox,
        .remove-days-checkbox { 
            display: flex;
            align-items: center;
            white-space: nowrap;
            flex-shrink: 0;
        }
        
        .now-time-checkbox label, 
        .repeat-first-checkbox label,
        .input-type-checkbox label,
        .remove-days-checkbox label { 
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            cursor: pointer;
        }
        
        .now-time-checkbox input[type="checkbox"] {
            transform: scale(1.4);
            accent-color: var(--accent-red); /* Kırmızı */
        }
        
        .repeat-first-checkbox input[type="checkbox"] {
            transform: scale(1.4);
            accent-color: var(--accent-red); /* Kırmızı */
        }

        .input-type-checkbox input[type="checkbox"],
        .remove-days-checkbox input[type="checkbox"] { 
            transform: scale(1.4);
            accent-color: var(--accent-blue); /* Mavi */
        }
        
        .now-time-checkbox span, 
        .repeat-first-checkbox span,
        .input-type-checkbox span,
        .remove-days-checkbox span { 
            font-size: var(--font-size-md);
            color: var(--text-primary);
        }

        /* Ortak Buton Stilleri */
        .create-button, #copySqlBtn, #modalOkBtn {
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-weight: 600;
            transition: background-color var(--transition-slow) ease, 
                       transform var(--transition-normal) ease, 
                       box-shadow var(--transition-normal) ease;
        }

        /* Ana Buton */
        .create-button {
            padding: 16px 35px;
            font-size: var(--font-size-xl);
            background-color: var(--accent-blue);
            color: white;
            box-shadow: 0 4px 10px #2b517e;
            margin-top: 30px;
            margin-left: 9cm; /* Merkezleme için geçici çözüm, responsive'de değişiyor */
        }
        
        .create-button:hover {
            background-color: var(--accent-blue-light);
            transform: translateY(-3px);
            box-shadow: 0 6px 6px var(--accent-blue-active);
        }
        
        .create-button:active {
            transform: translateY(0);
            background-color: var(--accent-blue-active);
            box-shadow: inset 0 2px 4px var(--shadow-medium);
        }

        /* SQL Çıktısı Alanı */
        #sqlOutputContainer {
            margin-top: 40px;
            background-color: var(--bg-tertiary);
            color: var(--text-secondary);
            font-family: var(--font-code);
            font-size: 0.9em;
            white-space: pre-wrap;
            word-break: break-all;
            position: relative;
            min-height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        #sqlOutput {
            padding-top: var(--spacing-sm);
            width: 100%;
            box-sizing: border-box;
            color: var(--text-muted);
            font-style: italic;
            white-space: pre-wrap;
            overflow-wrap: break-word;
            text-align: left;
            padding-left: var(--spacing-sm);
            overflow-y: auto;
            flex-grow: 1;
        }

        /* Kopyala Butonu */
        #copySqlBtn {
            position: absolute;
            top: var(--spacing-md);
            right: var(--spacing-lg);
            background-color: var(--border-color);
            color: var(--text-secondary);
            padding: 8px 16px;
            font-size: 0.9em;
            z-index: 2;
            box-shadow: 0 2px 5px var(--shadow-light);
        }
        
        #copySqlBtn:hover {
            background-color: #586069;
            transform: translateY(-1px);
        }
        
        #copySqlBtn:active {
            transform: translateY(0);
            background-color: #3b424d;
            box-shadow: inset 0 1px 3px var(--shadow-medium);
        }

        /* Modal Stilleri */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            display: none; /* Varsayılan olarak gizli */
        }

        .modal-content {
            background-color: var(--bg-secondary);
            padding: var(--spacing-xxl);
            border-radius: var(--border-radius-large);
            box-shadow: 0 8px 20px var(--shadow-medium);
            border: 1px solid var(--border-color);
            max-width: 500px;
            width: 90%;
            text-align: center;
            color: var(--text-primary);
        }

        .modal-title {
            color: var(--accent-red);
            font-size: var(--font-size-xl);
            margin-bottom: var(--spacing-md);
            font-weight: 600;
        }

        .modal-message {
            font-size: var(--font-size-md);
            margin-bottom: var(--spacing-xl);
            line-height: 1.5;
        }

        #modalOkBtn {
            background-color: var(--accent-blue);
            color: white;
            padding: 10px 25px;
            font-size: var(--font-size-lg);
        }

        #modalOkBtn:hover {
            background-color: var(--accent-blue-light);
            transform: translateY(-2px);
        }
        
        #modalOkBtn:active {
            transform: translateY(0);
            background-color: var(--accent-blue-active);
        }


        /* Responsive Tasarım */
        @media (max-width: 768px) {
            .container, #sqlOutputContainer {
                width: 95%;
                padding: var(--spacing-lg);
            }
            
            h1 {
                font-size: 2em;
                margin-bottom: var(--spacing-xl);
            }
            
            .item-row {
                flex-direction: column;
                align-items: stretch;
            }
            
            .checkbox-container, .column-label-group, 
            .content-and-options-wrapper { /* Yeni sarmalayıcı da responsive kurallara uyacak */
                margin-right: 0;
                margin-bottom: var(--spacing-sm);
                width: 100%;
            }
            
            .column-label-group {
                min-width: unset;
            }
            
            .text-area-container {
                margin-bottom: var(--spacing-md);
            }
            
            .content-and-options-wrapper {
                flex-direction: column; /* Küçük ekranlarda yine dikey sırala */
                align-items: stretch;
            }

            .checkbox-options-group { /* Bu grup zaten dikey sıralı olduğu için ek bir flex-direction gerekmez */
                margin-left: 0; /* Küçük ekranda margin-left'i sıfırla */
                align-items: flex-start; /* Checkbox'ları sola hizala */
                padding-top: var(--spacing-sm); /* Responsive'de de boşluk bırak */
            }
            
            .create-button {
                width: 100%;
                padding: 14px var(--spacing-lg);
                font-size: 1.1em;
                margin-left: 0; /* Responsive'de merkezlemeyi kaldır */
            }

            .platesub {
            color: var(--accent-red);
            margin-bottom: 35px;
            margin-top: 35px;
            font-size: var(--font-size-xl);
            letter-spacing: 1.5px;
            text-shadow: 0 2px 5px var(--shadow-medium);
            text-align: center;
            }
            
            .red-line {
                border: none;
                height: 2px;
                background-color: var(--accent-red);
                margin: 20px 0;
                width: 100%;
                align-self: stretch;
            }

            #copySqlBtn {
                position: static;
                width: 100%;
                margin-top: var(--spacing-md);
                margin-bottom: var(--spacing-sm);
                text-align: center;
            }
            
            #sqlOutput {
                max-height: 180px;
            }

        }
    </style>
</head>
<body>

    <h1 class="platesub">Whitelist Inserter</h1>

<div class="container">
    <div class="info-notes">
        <p class="red-note">Not: Excel'den kopyalanan her satır, sistem tarafından ayrı bir INSERT komutu olarak işlenir. Lütfen verileri satır satır yapıştırınız ve tüm satırların aynı sayıda veri içerdiğinden emin olunuz.</p>
        <p class="orange-note">created_at, created_by_id, park_id, description gibi sabit alanlar tek bir satır olarak girilebilir; bu değerler, diğer tüm verilerle birlikte otomatik olarak her INSERT komutuna dahil edilecektir.</p>
    </div>

        <h4 class="required-field-header">zorunlu alan</h4>

    <div style="display: flex;align-items: flex-start;padding-top: 20px; margin-bottom: 50px;padding-bottom: 20px;border-bottom: 3px solid #ff4d4d;border-top:  3px solid #ff4d4d;">
        <div class="checkbox-container">
            <input type="checkbox" id="plate_check" checked disabled>
        </div>
        <div class="column-label-group">
            <div class="column-name">plate</div>
            <div class="column-description">(Plaka)</div>
        </div>
        <div class="content-and-options-wrapper">
            <div class="text-area-container">
                <textarea id="plate_text" placeholder="Örn: 34GTY132"></textarea>
            </div>
            </div>
    </div>
    <div class="item-row" style="padding-top: 10px; border-top: 2px solid #4d94ff;">
        <div class="checkbox-container">
            <input type="checkbox" id="created_by_id_check" disabled checked>
        </div>
        <div class="column-label-group">
            <div class="column-name">created_by_id</div>
            <div class="column-description">(Oluşturan kişi ID)</div>
        </div>
        <div class="content-and-options-wrapper">
            <div class="text-area-container">
                <textarea id="created_by_id_text" placeholder="Örn: 10675"></textarea>
            </div>
            <div class="checkbox-options-group">
                <div class="repeat-first-checkbox">
                    <label>
                        <input type="checkbox" id="created_by_id_repeat_check" checked>
                        <span>İlk Satırı Tekrarla</span>
                    </label>
                </div>
            </div>
        </div>
    </div>

    <div class="item-row">
        <div class="checkbox-container">
            <input type="checkbox" id="park_id_check" disabled checked>
        </div>
        <div class="column-label-group">
            <div class="column-name">park_id</div>
            <div class="column-description">(Parkın ID'si)</div>
        </div>
        <div class="content-and-options-wrapper">
            <div class="text-area-container">
                <textarea id="park_id_text" placeholder="Örn: 77"></textarea>
            </div>
            <div class="checkbox-options-group">
                <div class="repeat-first-checkbox">
                    <label>
                        <input type="checkbox" id="park_id_repeat_check" checked>
                        <span>İlk Satırı Tekrarla</span>
                    </label>
                </div>
            </div>
        </div>
    </div>

    <div class="item-row">
        <div class="checkbox-container">
            <input type="checkbox" id="created_at_check" disabled checked>
        </div>
        <div class="column-label-group">
            <div class="column-name">created_at</div>
            <div class="column-description"></div>
        </div>
        <div class="content-and-options-wrapper">
            <div class="text-area-container">
                <textarea id="created_at_text" placeholder="YYYY-MM-DD HH:MM:SS formatında giriniz..."></textarea>
            </div>
            <div class="checkbox-options-group">
                <div class="now-time-checkbox">
                    <label>
                        <input type="checkbox" id="created_at_now_check">
                        <span>Şimdiki Zaman</span>
                    </label>
                </div>
            </div>
        </div>
    </div>

    <div class="item-row">
        <div class="checkbox-container">
            <input type="checkbox" id="expiry_at_check">
        </div>
        <div class="column-label-group">
            <div class="column-name">expiry_at</div>
            <div class="column-description">(Geçerlilik Tarihi)</div>
        </div>
        <div class="content-and-options-wrapper">
            <div class="text-area-container">
                <textarea id="expiry_at_text" placeholder="YYYY-MM-DD HH:MM:SS formatında giriniz..."></textarea>
            </div>
            <div class="checkbox-options-group">
                <div class="now-time-checkbox">
                    <label>
                        <input type="checkbox" id="expiry_at_now_check">
                        <span>Şimdiki Zaman</span>
                    </label>
                </div>
                <div class="remove-days-checkbox">
                    <label>
                        <input type="checkbox" id="expiry_at_remove_days_check">
                        <span>SİL (kalan gün sayısı:x)</span>
                    </label>
                </div>
            </div>
        </div>
    </div>

    <div class="item-row">
        <div class="checkbox-container">
            <input type="checkbox" id="name_check">
        </div>
        <div class="column-label-group">
            <div class="column-name">name</div>
            <div class="column-description">(Müşteri Adı)</div>
        </div>
        <div class="content-and-options-wrapper">
            <div class="text-area-container">
                <textarea id="name_text" placeholder="Örn: EMRE"></textarea>
            </div>
            <div class="checkbox-options-group">
                <div class="repeat-first-checkbox">
                    <label>
                        <input type="checkbox" id="name_repeat_check"> <span>İlk Satırı Tekrarla</span>
                    </label>
                </div>
            </div>
        </div>
    </div>

    <div class="item-row">
        <div class="checkbox-container">
            <input type="checkbox" id="company_name_check">
        </div>
        <div class="column-label-group">
            <div class="column-name">company_name</div>
            <div class="column-description">(Şirket Adı)</div>
        </div>
        <div class="content-and-options-wrapper">
            <div class="text-area-container">
                <textarea id="company_name_text" placeholder="Örn: 4B PLAZA"></textarea>
            </div>
            <div class="checkbox-options-group">
                <div class="repeat-first-checkbox">
                    <label>
                        <input type="checkbox" id="company_name_repeat_check"> <span>İlk Satırı Tekrarla</span>
                    </label>
                </div>
            </div>
        </div>
    </div>
    <div class="item-row">
        <div class="checkbox-container">
            <input type="checkbox" id="description_check">
        </div>
        <div class="column-label-group">
            <div class="column-name">description</div>
            <div class="column-description">(Açıklama)</div>
        </div>
        <div class="content-and-options-wrapper">
            <div class="text-area-container">
                <textarea id="description_text" placeholder="Örn: Malik"></textarea>
            </div>
            <div class="checkbox-options-group">
                <div class="repeat-first-checkbox">
                    <label>
                        <input type="checkbox" id="description_repeat_check"> <span>İlk Satırı Tekrarla</span>
                    </label>
                </div>
            </div>
        </div>
    </div>

    <div class="item-row">
        <div class="checkbox-container">
            <input type="checkbox" id="payment_status_check">
        </div>
        <div class="column-label-group">
            <div class="column-name">payment_status</div>
            <div class="column-description">(Ödeme Durumu)</div>
        </div>
        <div class="content-and-options-wrapper">
            <div class="text-area-container">
                <textarea id="payment_status_text" placeholder="Örn: Ücretsiz: 1 || Ödenmiş: 2 || Ödememiş: 3"></textarea>
            </div>
            <div class="checkbox-options-group">
                <div class="repeat-first-checkbox">
                    <label>
                        <input type="checkbox" id="payment_status_repeat_check"> <span>İlk Satırı Tekrarla</span>
                    </label>
                </div>
                <div class="input-type-checkbox">
                    <label>
                        <input type="checkbox" id="payment_status_input_type_check">
                        <span>Giriş tipi: 1,2,3</span>
                    </label>
                </div>
            </div>
        </div>
    </div>

    <div class="item-row">
        <div class="checkbox-container">
            <input type="checkbox" id="phone_check">
        </div>
        <div class="column-label-group">
            <div class="column-name">phone</div>
            <div class="column-description">(Telefon Numarası)</div>
        </div>
        <div class="content-and-options-wrapper">
            <div class="text-area-container">
                <textarea id="phone_text" placeholder="Örn: 5551234567"></textarea>
            </div>
            <div class="checkbox-options-group">
                <div class="repeat-first-checkbox">
                    <label>
                        <input type="checkbox" id="phone_repeat_check"> <span>İlk Satırı Tekrarla</span>
                    </label>
                </div>
            </div>
        </div>
    </div>

    <div class="item-row">
        <div class="checkbox-container">
            <input type="checkbox" id="payment_amount_check">
        </div>
        <div class="column-label-group">
            <div class="column-name">payment_amount</div>
            <div class="column-description">(Ödeme Miktarı)</div>
        </div>
        <div class="content-and-options-wrapper">
            <div class="text-area-container">
                <textarea id="payment_amount_text" placeholder="Örn: 15.75"></textarea>
            </div>
            <div class="checkbox-options-group">
                <div class="repeat-first-checkbox">
                    <label>
                        <input type="checkbox" id="payment_amount_repeat_check"> <span>İlk Satırı Tekrarla</span>
                    </label>
                </div>
            </div>
        </div>
    </div>

    <button class="create-button" id="createButton">SQL Sorgusu Oluştur</button>
</div>

<div id="sqlOutputContainer">
    <button id="copySqlBtn" title="Kopyala">Kopyala</button>
    <pre id="sqlOutput">Veri giriniz.</pre>
</div>

<div id="errorModalOverlay" class="modal-overlay">
    <div class="modal-content">
        <h3 id="modalTitle" class="modal-title">Hata!</h3>
        <p id="modalMessage" class="modal-message"></p>
        <button id="modalOkBtn">Tamam</button>
    </div>
</div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const createButton = document.getElementById('createButton');
            const sqlOutput = document.getElementById('sqlOutput');
            const copySqlBtn = document.getElementById('copySqlBtn');
            const errorModalOverlay = document.getElementById('errorModalOverlay');
            const modalTitle = document.getElementById('modalTitle');
            const modalMessage = document.getElementById('modalMessage');
            const modalOkBtn = document.getElementById('modalOkBtn');


            // Kopyala butonu işlevi
            if (copySqlBtn) {
                copySqlBtn.addEventListener('click', () => {
                    const sql = sqlOutput.textContent;
                    if (sql && sql.trim() !== "" && sql !== "Veri giriniz." && !sql.startsWith("Hata:")) {
                        // Geçici bir textarea oluştur
                        const tempTextArea = document.createElement('textarea');
                        tempTextArea.value = sql;
                        document.body.appendChild(tempTextArea);
                        tempTextArea.select(); // Metni seç
                        document.execCommand('copy'); // Kopyala
                        document.body.removeChild(tempTextArea); // Geçici textarea'yı kaldır

                        copySqlBtn.textContent = "Kopyalandı!";
                        setTimeout(() => { copySqlBtn.textContent = "Kopyala"; }, 1200);
                    }
                });
            }

            // Alanların konfigürasyonu ve varsayılan durumları
            const fieldsConfig = {
                created_at: { checkboxId: 'created_at_check', textareaId: 'created_at_text', type: 'datetime', special: 'now_datetime', placeholder: 'YYYY-MM-DD HH:MM:SS formatında giriniz...', mandatory: true },
                created_by_id: { checkboxId: 'created_by_id_check', textareaId: 'created_by_id_text', type: 'int', hasRepeatOption: true, placeholder: 'Örn: 10675', mandatory: true },
                park_id: { checkboxId: 'park_id_check', textareaId: 'park_id_text', type: 'int', hasRepeatOption: true, placeholder: 'Örn: 77', mandatory: true },
                plate: { checkboxId: 'plate_check', textareaId: 'plate_text', type: 'varchar(255)', multiLine: true, placeholder: 'Örn: 34GTY132', mandatory: true }, 
                
                // Zorunlu olmayan alanlar (varsayılan olarak unchecked)
                expiry_at: { checkboxId: 'expiry_at_check', textareaId: 'expiry_at_text', type: 'datetime', special: 'now_datetime', placeholder: 'YYYY-MM-DD HH:MM:SS formatında giriniz...', mandatory: false, hasRemoveDaysOption: true }, 
                name: { checkboxId: 'name_check', textareaId: 'name_text', type: 'varchar(255)', hasRepeatOption: true, placeholder: 'Örn: EMRE', mandatory: false }, 
                company_name: { checkboxId: 'company_name_check', textareaId: 'company_name_text', type: 'varchar(255)', hasRepeatOption: true, placeholder: 'Örn: 4B PLAZA', mandatory: false }, 
                description: { checkboxId: 'description_check', textareaId: 'description_text', type: 'text', hasRepeatOption: true, placeholder: 'Örn: Malik', mandatory: false }, 
                payment_status: { checkboxId: 'payment_status_check', textareaId: 'payment_status_text', type: 'int', hasRepeatOption: true, hasInputTypeOption: true, placeholder: 'Örn: Ücretsiz: 1 || Ödenmiş: 2 || Ödememiş: 3', mandatory: false }, 
                phone: { checkboxId: 'phone_check', textareaId: 'phone_text', type: 'varchar(255)', hasRepeatOption: true, placeholder: 'Örn: 5551234567', mandatory: false }, 
                payment_amount: { checkboxId: 'payment_amount_check', textareaId: 'payment_amount_text', type: 'double(11,2)', hasRepeatOption: true, placeholder: 'Örn: 15.75', mandatory: false }, 
            };

            // SQL string değerlerini kaçış karakterleriyle düzenleme fonksiyonu
            function escapeSqlString(str) {
                if (typeof str !== 'string') {
                    return str; // String değilse olduğu gibi döndür
                }
                return str.replace(/'/g, "''"); // Tek tırnakları çift tırnak yapar
            }

            // Tarih formatı doğrulama regex'i (YYYY-MM-DD HH:MM:SS)
            const datetimeRegex = /^\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}$/;
            // Türk Plaka formatı doğrulama regex'i (Örn: 34ABC123, 06AB1234)
            const plateRegex = /^(?:[0-8][0-9]|[0-9]{2})[A-Z]{1,3}\d{2,4}$/i; 

            // Hata mesajını gösteren ve ilgili alana kaydıran yardımcı fonksiyon
            function showErrorAndScroll(message, element) {
                modalTitle.textContent = "Hata!";
                modalMessage.textContent = message;
                errorModalOverlay.style.display = 'flex'; // Modalı göster

                if (element) {
                    element.classList.add('error-border');
                    element.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            }

            // Modalı gizle
            modalOkBtn.addEventListener('click', () => {
                errorModalOverlay.style.display = 'none';
            });

            // Tüm textarea'lardan hata kenarlıklarını temizleyen fonksiyon
            function clearAllErrorBorders() {
                for (const fieldName in fieldsConfig) {
                    const textarea = document.getElementById(fieldsConfig[fieldName].textareaId);
                    if (textarea) {
                        textarea.classList.remove('error-border');
                    }
                }
            }

            // generateInsertSql fonksiyonu
            function generateInsertSql() {
                clearAllErrorBorders();
                sqlOutput.textContent = "Veri giriniz.";
                sqlOutput.style.color = 'var(--text-muted)';

                let columnsToInclude = new Set();
                let allRowsData = [];
                let plateLines = [];
                let hasValidationError = false;
                let firstErrorElement = null;

                // Python betiğindeki dönüşüm sözlüğü
                const donusum_sozlugu = {
                    "ücretsiz": "1",
                    "ödenmiş": "2",
                    "ödememiş": "3"
                };

                const plateTextarea = document.getElementById(fieldsConfig.plate.textareaId);
                let rawPlateLines = plateTextarea.value.split(/\r?\n/).map(line => line.trim());

                while (rawPlateLines.length > 0 && (rawPlateLines[rawPlateLines.length - 1] === '' || rawPlateLines[rawPlateLines.length - 1] === '-')) {
                    rawPlateLines.pop();
                }

                if (rawPlateLines.length === 0) {
                    showErrorAndScroll("Plaka alanı zorunludur ve boş bırakılamaz.", plateTextarea);
                    return null; // Return null to indicate error
                }
                
                // Plaka formatı doğrulama
                for (let i = 0; i < rawPlateLines.length; i++) {
                    const plate = rawPlateLines[i];
                    if (plate === '') { // Plaka satırı boş olmamalı
                        showErrorAndScroll(`Plaka alanı (satır ${i + 1}) zorunludur ve boş bırakılamaz.`, plateTextarea);
                        return null;
                    }
                    if (!plateRegex.test(plate)) {
                        showErrorAndScroll(`Plaka formatı geçersiz (satır ${i + 1}): '${plate}'. Lütfen doğru formatta giriniz (örn: 34ABC123).`, plateTextarea);
                        return null; 
                    }
                }

                plateLines = rawPlateLines;
                const plateLinesCount = plateLines.length;

                for (let i = 0; i < plateLinesCount; i++) {
                    let currentRowValues = {};

                    for (const fieldName in fieldsConfig) {
                        const config = fieldsConfig[fieldName];
                        const checkbox = document.getElementById(config.checkboxId);
                        const textarea = document.getElementById(config.textareaId);
                        const repeatCheckbox = config.hasRepeatOption ? document.getElementById(fieldName + '_repeat_check') : null;
                        const nowCheckbox = config.special === 'now_datetime' ? document.getElementById(fieldName + '_now_check') : null;
                        const inputTypeCheckbox = config.hasInputTypeOption ? document.getElementById(fieldName + '_input_type_check') : null;
                        const removeDaysCheckbox = config.hasRemoveDaysOption ? document.getElementById(fieldName + '_remove_days_check') : null;


                        let valueToProcess = null;
                        let isFieldChecked = checkbox && checkbox.checked;
                        let isSqlFunction = false; // Flag to indicate if the value is an SQL function (like NOW())

                        if (isFieldChecked) {
                            columnsToInclude.add(fieldName);

                            let effectiveValueForThisRow = ''; // Initialize

                            // First, determine the effective value for this row (from textarea or repeat option)
                            if (fieldName === 'plate') {
                                effectiveValueForThisRow = plateLines[i];
                            } else if (nowCheckbox && nowCheckbox.checked) {
                                valueToProcess = 'NOW()'; // If 'Şimdiki Zaman' is checked, it overrides other input
                                isSqlFunction = true;
                            } else if (repeatCheckbox && repeatCheckbox.checked) {
                                const firstLineValueRaw = textarea.value.split(/\r?\n/)[0]?.trim() || '';
                                effectiveValueForThisRow = (firstLineValueRaw === '' || firstLineValueRaw === '-') ? '' : firstLineValueRaw;
                                if (effectiveValueForThisRow === '') {
                                    showErrorAndScroll(`${config.placeholder.split(':')[0]} alanı için 'İlk Satırı Tekrarla' seçeneği işaretli ancak ilk satır boş bırakılamaz.`, textarea);
                                    hasValidationError = true;
                                    if (!firstErrorElement) firstErrorElement = textarea;
                                    break; // Exit inner loop
                                }
                            } else {
                                const allLines = textarea.value.split(/\r?\n/).map(line => line.trim());
                                if (allLines.length === 1) {
                                    effectiveValueForThisRow = allLines[0];
                                } else if (allLines.length > 1 && allLines.length !== plateLinesCount) {
                                    showErrorAndScroll(`${config.placeholder.split(':')[0]} alanı için girilen satır sayısı (${allLines.length}), plaka satır sayısı (${plateLinesCount}) ile eşleşmiyor.`, textarea);
                                    hasValidationError = true;
                                    if (!firstErrorElement) firstErrorElement = textarea;
                                    break; // Exit inner loop
                                } else {
                                    effectiveValueForThisRow = allLines[i] || '';
                                }
                            }

                            if (hasValidationError) { // If any validation failed while determining effectiveValueForThisRow, break outer loop
                                break;
                            }

                            // Now, process the effectiveValueForThisRow based on field specific rules
                            if (isSqlFunction) {
                                // valueToProcess is already set to 'NOW()' or similar
                            } else if (fieldName === 'created_at') {
                                // Specific validation and conversion for created_at
                                if (effectiveValueForThisRow === '') {
                                    showErrorAndScroll(`${config.placeholder.split(':')[0]} alanı zorunludur ve boş bırakılamaz. 'Şimdiki Zaman' seçeneğini işaretleyebilir veya geçerli bir tarih giriniz.`, textarea);
                                    hasValidationError = true;
                                    if (!firstErrorElement) firstErrorElement = textarea;
                                    break;
                                } else if (effectiveValueForThisRow.toLowerCase() === 'limitsiz') {
                                    valueToProcess = 'NULL';
                                } else {
                                    const yyyymmdd_hhmmss_regex = /^\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}$/;
                                    const ddmmyyyy_hhmmss_regex = /^\d{2}-\d{2}-\d{4} \d{2}:\d{2}:\d{2}$/;

                                    if (yyyymmdd_hhmmss_regex.test(effectiveValueForThisRow)) {
                                        valueToProcess = effectiveValueForThisRow;
                                    } else if (ddmmyyyy_hhmmss_regex.test(effectiveValueForThisRow)) {
                                        // Convert DD-MM-YYYY HH:MM:SS to YYYY-MM-DD HH:MM:SS
                                        const parts = effectiveValueForThisRow.split(/[- :]/); // Split by '-', ' ', ':'
                                        const day = parts[0];
                                        const month = parts[1];
                                        const year = parts[2];
                                        const hour = parts[3];
                                        const minute = parts[4];
                                        const second = parts[5];
                                        valueToProcess = `${year}-${month}-${day} ${hour}:${minute}:${second}`;
                                    } else {
                                        showErrorAndScroll(`'${config.placeholder.split(':')[0]}' alanı için geçersiz tarih/saat formatı: '${effectiveValueForThisRow}'. Desteklenen formatlar YYYY-MM-DD HH:MM:SS veya DD-MM-YYYY HH:MM:SS'dir.`, textarea);
                                        hasValidationError = true;
                                        if (!firstErrorElement) firstErrorElement = textarea;
                                        break;
                                    }
                                }
                            } else if (fieldName === 'expiry_at') {
                                // Specific validation and conversion for expiry_at (similar to created_at but can be empty/NULL)
                                let processedEffectiveValue = effectiveValueForThisRow;
                                if (removeDaysCheckbox && removeDaysCheckbox.checked) {
                                    processedEffectiveValue = processedEffectiveValue.replace(/\s*Kalan gün:\s*\d+/i, '').trim();
                                }

                                if (processedEffectiveValue === '' || processedEffectiveValue === '-') {
                                    valueToProcess = 'NULL';
                                } else if (processedEffectiveValue.toLowerCase() === 'limitsiz') {
                                    valueToProcess = 'NULL';
                                } else {
                                    const yyyymmdd_hhmmss_regex = /^\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}$/;
                                    const ddmmyyyy_hhmmss_regex = /^\d{2}-\d{2}-\d{4} \d{2}:\d{2}:\d{2}$/;

                                    if (yyyymmdd_hhmmss_regex.test(processedEffectiveValue)) {
                                        valueToProcess = processedEffectiveValue;
                                    } else if (ddmmyyyy_hhmmss_regex.test(processedEffectiveValue)) {
                                        const parts = processedEffectiveValue.split(/[- :]/);
                                        const day = parts[0];
                                        const month = parts[1];
                                        const year = parts[2];
                                        const hour = parts[3];
                                        const minute = parts[4];
                                        const second = parts[5];
                                        valueToProcess = `${year}-${month}-${day} ${hour}:${minute}:${second}`;
                                    } else {
                                        showErrorAndScroll(`'${config.placeholder.split(':')[0]}' alanı için geçersiz tarih/saat formatı: '${processedEffectiveValue}'. Desteklenen formatlar YYYY-MM-DD HH:MM:SS veya DD-MM-YYYY HH:MM:SS'dir.`, textarea);
                                        hasValidationError = true;
                                        if (!firstErrorElement) firstErrorElement = textarea;
                                        break;
                                    }
                                }
                            } else if (fieldName === 'description' && isFieldChecked) {
                                // Description special handling
                                if (effectiveValueForThisRow === 'NULL' || effectiveValueForThisRow === '') {
                                    valueToProcess = `DATE_FORMAT(NOW(), '%Y-%m-%d')`;
                                } else {
                                    valueToProcess = `CONCAT('${escapeSqlString(effectiveValueForThisRow)} ', DATE_FORMAT(NOW(), '%Y-%m-%d'))`;
                                }
                                isSqlFunction = true;
                            } else if (fieldName === 'payment_status') {
                                if (inputTypeCheckbox && inputTypeCheckbox.checked) {
                                    // Eğer payment_status_input_type_check tikliyse, valueToProcess ne olursa olsun 1, 2 veya 3 olmalı
                                    const validPaymentStatusValues = ['1', '2', '3'];
                                    if (effectiveValueForThisRow === null || !validPaymentStatusValues.includes(String(effectiveValueForThisRow))) {
                                        showErrorAndScroll(`'Giriş tipi: 1,2,3' seçeneği işaretli olduğundan 'payment_status' alanı 1, 2 veya 3 olmalıdır. Girilen değer: '${effectiveValueForThisRow}'.`, textarea);
                                        hasValidationError = true;
                                        if (!firstErrorElement) firstErrorElement = textarea;
                                        break;
                                    }
                                    valueToProcess = effectiveValueForThisRow; // Use as is if valid number
                                } else {
                                    // Eğer payment_status_input_type_check tikli DEĞİLSE, dönüşüm yap
                                    let convertedValue = effectiveValueForThisRow;
                                    if (convertedValue === '' || convertedValue === '-') {
                                        convertedValue = 'NULL';
                                    } else {
                                        const lowerCaseValue = String(convertedValue).toLowerCase();
                                        if (donusum_sozlugu[lowerCaseValue]) {
                                            convertedValue = donusum_sozlugu[lowerCaseValue];
                                        } else {
                                            // Dönüşüm sözlüğünde yoksa ve 1, 2, 3 de değilse hata ver
                                            const isNumericValue = ['1', '2', '3'].includes(String(convertedValue));
                                            if (!isNumericValue) {
                                                showErrorAndScroll(`'payment_status' alanı için 'Giriş tipi: 1,2,3' seçeneği tikli DEĞİL ise sadece 'ücretsiz', 'ödenmiş', 'ödememiş' metinleri veya 1, 2, 3 sayıları kabul edilir. Geçersiz değer: '${effectiveValueForThisRow}'.`, textarea);
                                                hasValidationError = true;
                                                if (!firstErrorElement) firstErrorElement = textarea;
                                                break;
                                            }
                                        }
                                    }
                                    valueToProcess = convertedValue;
                                }
                            } else {
                                // General handling for other fields that are not special or have special options checked
                                if (effectiveValueForThisRow === '-' || effectiveValueForThisRow === '') {
                                    valueToProcess = 'NULL';
                                } else {
                                    valueToProcess = effectiveValueForThisRow;
                                }
                            }

                            if (textarea) {
                                textarea.classList.remove('error-border');
                            }

                            // Final type conversion before adding to rowData
                            if (!isSqlFunction) {
                                if (valueToProcess === 'NULL') {
                                    // Do nothing, already 'NULL'
                                } else if (config.type.startsWith('varchar') || config.type === 'text' || config.type === 'datetime') {
                                    valueToProcess = `'${escapeSqlString(valueToProcess)}'`;
                                } else if (config.type.startsWith('int')) {
                                    valueToProcess = parseInt(valueToProcess, 10);
                                    if (isNaN(valueToProcess)) valueToProcess = 'NULL';
                                } else if (config.type.startsWith('double')) {
                                    valueToProcess = parseFloat(valueToProcess.replace(',', '.'));
                                    if (isNaN(valueToProcess)) valueToProcess = 'NULL';
                                }
                            }
                            currentRowValues[fieldName] = valueToProcess;
                        } else {
                            if (textarea) {
                                textarea.classList.remove('error-border');
                            }
                        }
                    }

                    if (hasValidationError) {
                        return null;
                    }
                    allRowsData.push(currentRowValues);
                }

                if (hasValidationError) {
                    return null;
                }

                const desiredOrder = [
                    'created_at', 'created_by_id', 'updated_at', 'updated_by_id', 'plate', 'park_id',
                    'description', 'expiry_at', 'payment_status', 'phone', 'payment_amount',
                    'name', 'company', 'company_name'
                ];

                const finalSortedColumns = desiredOrder.filter(col => columnsToInclude.has(col));

                if (finalSortedColumns.length === 0) {
                    showErrorAndScroll("Oluşturulacak geçerli bir alan bulunamadı. Lütfen en az bir alan seçin ve doldurun.", null);
                    return null;
                }

                let allValuesStrings = [];
                allRowsData.forEach(rowData => {
                    const valuesForThisRow = finalSortedColumns.map(col => {
                        return rowData[col] !== undefined ? rowData[col] : 'NULL';
                    });
                    allValuesStrings.push(`(${valuesForThisRow.join(', ')})`);
                });

                return `INSERT INTO default_parking_whitelist\n\t(${finalSortedColumns.join(', ')})\nVALUES\n\t${allValuesStrings.join(',\n\t')};`;
            }

            // Main button click handler
            createButton.addEventListener('click', () => {
                const sql = generateInsertSql();
                if (sql) {
                    sqlOutput.textContent = sql;
                    sqlOutput.style.color = 'var(--text-secondary)';
                }
            });
        });
    </script>

</body>
</html>